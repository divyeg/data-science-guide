from nltk.corpus import stopwords
import string


class DataHandler(object):
    def __init__(self):
        pass

    def remove_punnctuations_from_text(self, text):
        """
        This function is used to remove punctuations from text

        """
        punctuations = string.punctuation
        return text.translate(str.maketrans("", "", punctuations))

    def remove_punctuations_from_df(self, df, text_column):
        """
        This function is used to remove punctuations from a text column in pandas DataFrame

        """
        df["text_wo_punct"] = df[text_column].apply(
            lambda text: self.remove_punnctuations_from_text(text)
        )
        return df

    def remove_stop_words_from_text(self, text):
        """
        This function is used to remove punctuations from a text

        """
        stop_words = stopwords.words("english")
        return " ".join([word for word in str(text).split() if word not in stop_words])

    def remove_stop_words_from_df(self, df, text_column):
        """
        This function is used to remove stop words from a text column in pandas DataFrame

        """
        df["text_wo_stopwords"] = df[text_column].apply(
            lambda text: self.remove_stop_words_from_text(text)
        )
        return df
